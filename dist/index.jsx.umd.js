!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom"),require("ionicons/icons"),require("@material-ui/core"),require("@material-ui/core/Box"),require("@material-ui/icons"),require("prop-types"),require("react-router-dom"),require("styled-components"),require("axios"),require("react-toastify"),require("@capacitor/core"),require("react-modal"),require("@ionic/react"),require("@material-ui/core/Drawer"),require("@material-ui/core/Fab"),require("@material-ui/core/IconButton"),require("@material-ui/core/List"),require("@material-ui/core/ListItem"),require("@material-ui/core/ListItemIcon")):"function"==typeof define&&define.amd?define(["exports","react","react-dom","ionicons/icons","@material-ui/core","@material-ui/core/Box","@material-ui/icons","prop-types","react-router-dom","styled-components","axios","react-toastify","@capacitor/core","react-modal","@ionic/react","@material-ui/core/Drawer","@material-ui/core/Fab","@material-ui/core/IconButton","@material-ui/core/List","@material-ui/core/ListItem","@material-ui/core/ListItemIcon"],t):t((e=e||self).ishlibjs={},e.react,e.ReactDOM,0,0,e._Box,e.icons$1,e.PropTypes,e.reactRouterDom,e.styled,e.axios,e.reactToastify,0,e.Modal,0,e.Drawer,e.Fab,e.IconButton,e.List,e.ListItem,e.ListItemIcon)}(this,function(e,t,r,n,a,o,l,i,c,s,u,d,m,p,f,h,g,y,v,x,E){var w="default"in t?t.default:t;function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(a[r]=e[r]);return a}function O(e,t){return t||(t=e.slice(0)),e.raw=t,e}r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,x=x&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x,E=E&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E;var P={anonUser:{},bottomDrawerOpen:"bottom-drawer-open",collapsible:{description:"descr-sec",extra1:"extra1-sec",extra2:"extra2-sec",extra3:"extra3-sec",map:"map-sec",markers:"markers-sec"},collapsibles:"collapsibles",current_user:"current_user",horizontal:"horizontal",item_types:{gallery:"Gallery",report:"Report",video:"Video"},jwt_token:"jwt_token",layout_onecol:"onecol",layout_mapui:"mapui",locations:{earth:"earth"},map_panel_types:{Equirectangular:"Equirectangular",MapPanel:"MapPanel",MapPanelNoZoom:"MapPanelNoZoom",ThreePanelV1:"ThreePanelV1",ThreePanelV4:"ThreePanelV4"},names:{scratchpad:"Scratchpad"},rated:{nc17:"nc-17"},ratedConfirmation:"rated-confirmation",theme:"theme",themes:{dark:"dark",light:"light"},twofoldPercent:"twofold-percent",variants:{bordered:"bordered",floating:"floating",inline:"inline",transparent:"transparent"},vertical:"vertical"};u.create({});var M,L,j,k,q,S,R,I,_,T,F,N,B,A,D=["children"],U=["children"],z=["children","onClose"],V=s.div(M||(M=O(["\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n"]))),J=(s.div(L||(L=O(["\n  margin-right: 5px;\n  cursor: pointer;\n"]))),s.div(j||(j=O(["\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n"])))),W=(s(l.ChevronLeft)(k||(k=O(["\n  color: ","\n"])),function(e){return e.theme.colors.text}),s(l.ChevronRight)(q||(q=O(["\n  color: ","\n"])),function(e){return e.theme.colors.text}),s(o)(S||(S=O(["\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ",";\n\n  display: flex;\n  flex-direction: column;\n"])),function(e){return e.cursor?e.cursor:"auto"}),function(e){var t=C(e,D);return w.createElement(l.Close,b({style:b({cursor:"pointer"},t.style)},t))});W.propTypes={onClick:i.func.isRequired};var H=s.div(R||(R=O(["\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n"]))),G=function(e){var t=e.children,r=C(e,U);return w.createElement(H,b({className:"FlexCol"},r),t)},Y=s.div(I||(I=O(["\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n"]))),Z=(s.div(_||(_=O(["\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n"]))),function(e,t,r){void 0===t&&(t=""),void 0===r&&(r=null),(r="string"==typeof r?r:t.replace(/\W/g,"")).length>0&&"undefined"!=typeof window&&(window[r]=e),console.log("+++ "+t+":",e)}),K=s(l.Menu)(T||(T=O(["\n  color: ","\n"])),function(e){return e.theme.colors.text}),$=s.div(F||(F=O(["\n  flex-grow: 1;\n  text-align: center;\n  font-size: 1.2rem;\n"]))),Q=function(e){var t=e.children,r=e.onClose;return C(e,z),w.createElement(Y,null,w.createElement($,null,t),w.createElement(W,{onClick:r}))};Q.propTypes={onClose:i.func.isRequired},s.div(N||(N=O(["\n  border: ",";\n  border-radius: ",";\n  background: ",";\n  padding: .5em;\n\n  margin-bottom: 1em;\n"])),function(e){return e.theme.thinBorder},function(e){return e.theme.thinBorderRadius},function(e){return e.theme.colors.cardBackground}),s.div(B||(B=O(["\n  border: ",";\n  border-radius: ",";\n  background: ",";\n  color: ",";\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n"])),function(e){return e.theme.thinBorder},function(e){return e.theme.thinBorderRadius},function(e){return e.theme.colors.cardBackground},function(e){return e.theme.colors.text}),s.div(A||(A=O(["\n  height: 100vh;\n"]))),w.createContext({});var X={LoginModal:"_2YolN",LoginModalOverlay:"_3hqvY",Notice:"_2ifwF"},ee=function(e){var r=e.onError,n=e.onSuccess,a=t.useContext(ne),o=a.loginModalOpen,l=a.setLoginModalOpen,i=a.setRegisterModalOpen,c=a.useApi,s=t.useState(""),u=s[0],d=s[1],m=t.useState(""),f=m[0],h=m[1],g=c(),y=function(e,t){try{return g.postLogin({email:e,password:t}).then(function(e){l(!1),n(e)}).catch(function(e){r(e)}),Promise.resolve()}catch(e){return Promise.reject(e)}};return p.setAppElement("body"),w.createElement(p,{className:"LoginModal "+X.LoginModal,isOpen:!!o,overlayClassName:X.LoginModalOverlay,portalClassName:X.LoginModalPortal},w.createElement(Q,{onClose:function(){return l(!1)}},"Login"),"string"==typeof o&&w.createElement(Y,null,w.createElement("div",{className:X.Notice},o)),w.createElement(G,null,w.createElement("label",{htmlFor:"email"},"Email"),w.createElement("input",{name:"email",type:"email",value:u,onChange:function(e){return d(e.target.value)}}),w.createElement("label",{htmlFor:"password"},"Password"),w.createElement("input",{name:"password",type:"password",value:f,onChange:function(e){return h(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&y(u,f)}}),w.createElement(Y,{style:{flexDirection:"row-reverse",justifyContent:"space-between",marginTop:"0.4em"}},w.createElement(J,{onClick:function(){return y(u,f)}},"Login"))),w.createElement("hr",{style:{margin:"2rem 0",borderWidth:"1px"}}),w.createElement(Y,{style:{justifyContent:"center"}},w.createElement("a",{onClick:function(){l(!1),i(!0)}},"Register Instead")))};ee.propTypes={onError:i.func,onSuccess:i.func};var te=function(e){var r=t.useContext(ne),n=r.setLoginModalOpen,a=r.registerModalOpen,o=r.setRegisterModalOpen,l=(0,r.useApi)(),i=t.useState(""),c=i[0],s=i[1],u=t.useState(""),m=u[0],f=u[1],h=t.useState(""),g=h[0],y=h[1];return w.createElement(p,{className:"LoginModal "+X.LoginModal,isOpen:a,overlayClassName:X.LoginModalOverlay,portalClassName:X.LoginModalPortal},w.createElement(Q,{onClose:function(){return o(!1)}},"Register"),w.createElement(G,null,w.createElement("label",{htmlFor:"email"},"Email"),w.createElement("input",{type:"email",name:"email",value:c,onChange:function(e){return s(e.target.value)}}),w.createElement("label",{htmlFor:"password"},"Password"),w.createElement("input",{type:"password",name:"password",value:m,onChange:function(e){return f(e.target.value)}}),w.createElement("label",{htmlFor:"password2"},"Confirm Password"),w.createElement("input",{type:"password",name:"password2",value:g,onChange:function(e){return y(e.target.value)}}),w.createElement(Y,{style:{flexDirection:"row-reverse",justifyContent:"space-between",marginTop:"0.4em"}},w.createElement(J,{className:"Submit",onClick:function(){return function(e,t,r){try{return t!==r?(d.toast("Passwords do not match"),Promise.resolve()):(l.doRegister({email:e,password:t}).then(function(e){o(!1),n(e.message)}).catch(function(e){d.toast("Registration failed")}),Promise.resolve())}catch(e){return Promise.reject(e)}}(c,m,g)}},"Register")),w.createElement("hr",{style:{margin:"2rem 0",borderWidth:"1px"}}),w.createElement(Y,{style:{justifyContent:"center"}},w.createElement("a",{onClick:function(){return n(!0)||o(!1)}},"Login Instead"))))};te.propTypes={};var re=["children"],ne=t.createContext({}),ae=function(e){var r=e.children,n=C(e,re);Z(n,"AuthContextProvider");var a=n.currentUser,o=void 0===a?P.anonUser:a,l=n.setCurrentUser,i=n.loginModalOpen,c=void 0!==i&&i,s=n.setLoginModalOpen,u=n.registerModalOpen,d=void 0!==u&&u,m=n.setRegisterModalOpen,p=t.useState(o),f=p[0],h=p[1];l&&(f=o,h=l);var g=t.useState(c),y=g[0],v=g[1];s&&(y=c,v=s);var x=t.useState(d),E=x[0],O=x[1];return m&&(E=d,O=m),w.createElement(ne.Provider,{value:b({},n,{currentUser:f,setCurrentUser:h,loginModalOpen:y,setLoginModalOpen:v,registerModalOpen:E,setRegisterModalOpen:O})},r)};ae.propTypes={useApi:i.func.isRequired};const oe=e=>{Z(e,"Marker");const{label:t="<none>"}=e;return w.createElement(w.Fragment,null,w.createElement("div",{className:"Card",style:{border:"1px solid red",borderRadius:"10px",padding:"10px",maxWidth:"400px"}},"I am a marker! Label: `",t,"`."))},le=()=>w.createElement(Fragment,null,w.createElement("h1",null,"Hello, world!"),w.createElement(oe,null)),ie=w.createContext({}),ce=e=>{let{children:r,...n}=e;Z(n,"JwtContextProvider 222");const{api:a}=n,[o,l]=t.useState({}),[i,c]=t.useState({});return t.useEffect(()=>{Z("setting currentUser..."),a.getMyAccount().then(e=>{Z(e,"got this resp"),l(e)}).catch(e=>{Z(e,"e322"),d.toast("Login failed: "+e),l({})})},[]),w.createElement(ie.Provider,{value:{api:a,currentUser:o,setCurrentUser:l,loginModalOpen:i,setLoginModalOpen:c}},r)};ce.props={api:i.object};const se=s.div`
  display: flex;

  > * {
    margin: auto .4em;
  }
`,ue=s.div`
  border: 1px solid red;
`,de=s.div`
  display: flex;
`,me=(s.div`
  display: flex;

  > * {
    // margin: auto .4em;
  }
`,()=>{const{setCurrentUser:e}=t.useContext(ie);return w.createElement(J,{onClick:()=>{localStorage.removeItem("jwt_token"),e({})}},"Logout")});var pe={__proto__:null,JwtContext:ie,JwtContextProvider:ce,SimpleJwtRow:()=>{const{currentUser:e}=t.useContext(ie);return w.createElement(ue,null,w.createElement(se,null,e.email&&w.createElement(de,null,w.createElement("i",null,e.email),w.createElement(me,null))))},Logout:me};const fe=s.div`
`,he=e=>{const{useApi:r}=t.useContext(ne),n=r(),[a,o]=t.useState(localStorage.getItem(P.names.scratchpad)||"");return w.createElement(fe,null,w.createElement("textarea",{name:"scratchpad",rows:"20",cols:"40",onChange:e=>o(e.target.value),value:a}),w.createElement(V,null,w.createElement(J,{onClick:()=>{localStorage.setItem(P.names.scratchpad,a),n.postProfile({scratchpad:a}).then(e=>{}).catch(e=>{Z("Cannot update profile:",e)})}},"Save")))};he.propTypes={};const ge=s.div`
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  align-content: space-between;
`,ye=e=>{let{children:r,...n}=e;const{listItems:a}=n,[o,l]=w.useState(!1),[i,s]=t.useState(!1),u=c.useHistory();return w.createElement(t.Fragment,null,n.variant===P.variants.floating?w.createElement(g,{onClick:()=>l(!0),style:{position:"absolute",top:0,left:0,margin:".5em",zIndex:1},"aria-label":"main menu"},w.createElement(K,null)):w.createElement(K,{onClick:()=>l(!0)}),w.createElement(h,{anchor:"left",open:o,onClose:()=>l(!1)},w.createElement(ge,null,w.createElement(v,null,a.map(e=>{let{label:t,key:r,path:n}=e;return w.createElement(x,{button:!0,key:r,onClick:()=>{l(!1),u.push(n())}},t)})),r)))};ye.propTypes={listItems:i.array.isRequired,variant:i.string},process.env.REACT_APP_SERVE&&r.render(w.createElement(le,null),document.getElementById("root")),e.Actions=V,e.AuthContext=ne,e.AuthContextProvider=ae,e.CloseBtn=W,e.FlexCol=G,e.FlexRow=Y,e.LoginModal=ee,e.ModalHeader=Q,e.RegisterModal=te,e.Scratchpad=he,e.SideMenu=ye,e.jwtManager=pe,e.logg=Z});
//# sourceMappingURL=index.jsx.umd.js.map
