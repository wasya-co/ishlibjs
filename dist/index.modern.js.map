{"version":3,"file":"index.modern.js","sources":["../src/shared/C.jsx","../src/components/users/AuthWidget.jsx","../src/components/users/LoginModal.jsx","../src/components/users/RegisterModal.jsx","../src/components/users/index.jsx","../src/shared/request.jsx","../src/shared/S.jsx","../src/shared/index.jsx","../src/components/users/JwtContext.jsx","../src/components/users/PasswordLogin.jsx","../src/components/users/Scratchpad.jsx","../src/components/SideMenu/index.jsx"],"sourcesContent":["\n/**\n * Constants\n *\n * * C.anonUser\n * * C.current_user\n * * C.jwt_token\n * * C.item_types\n *\n */\nconst C = {\n\n  // A\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: {\n    scratchpad: 'Scratchpad',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","\nimport React, { Fragment as F, useContext, } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext, AuthContextProvider,\n  FacebookLogin,\n  LoginModal, LoginWithEmail,\n  RegisterModal, RegisterWithEmail,\n} from \"$components/users\"\n\nimport {\n  Btn,\n  C,\n  FlexCol, FlexRow,\n\n  logg,\n} from \"$shared\"\n\n\nconst RegisterWithEmailBtn = (props) => {\n  return <Btn {...props} >Register with Email</Btn>\n}\nconst LoginWithEmailBtn = (props) => {\n  return <Btn {...props} >Login with Email</Btn>\n}\n\n\n/**\n * If user is logged in, display the email/handle and allow logout.\n * If user is not logged in, allow registration and login via Fb, and email+passwd.\n**/\nconst AuthWidget = (props) => {\n  // logg(props, 'AuthWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n    setRegisterModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'AuthWidgetUsedAuthContext')\n\n  // @TODO: does this belong here?\n  const doLogout = () => {\n    setCurrentUser(JSON.stringify(C.anonUser))\n  }\n\n  if (currentUser?.email) {\n    return <FlexRow>\n      [{currentUser.email} <Btn onClick={doLogout} >Logout</Btn> ]\n    </FlexRow>\n  }\n\n  return <F>\n    <FlexCol>\n      <FacebookLogin />\n      <RegisterWithEmailBtn onClick={() => { setRegisterModalOpen(true) }} />\n      <LoginWithEmailBtn    onClick={() => { setLoginModalOpen(true) }} />\n    </FlexCol>\n\n    <RegisterModal />\n    <LoginModal />\n\n  </F>\n};\nAuthWidget.propTypes = {\n  // none so far\n}\n\nexport default AuthWidget\n","\n/*\n * components / users / PasswordLoginModal.jsx\n**/\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthContext, AuthContextProvider,\n} from './'\n\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\nimport styles from './LoginModal.scss'\n\n/**\n * LoginModal\n**/\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal, ishlibjs')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LoginModalUsedAuthContext2')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const api = useApi()\n\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((r) => {\n      setLoginModalOpen(false)\n      toast('Login Successful.')\n    }).catch((err) => {\n      logg(err, 'e323')\n      toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={loginModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    // portalClassName={'LoginModalPortal'}\n  >\n    <FlexRow style={{ flexDirection: 'row-reverse' }} >\n      <CloseBtn onClick={() => setLoginModalOpen(false)} />\n    </FlexRow>\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input name='email' type='email' value={email} onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input name='password' type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n        onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n      />\n      <FlexRow style={{\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <span>Forgot?</span>\n        <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport React, { useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\n\nimport {\n  AuthContext,\n  Btn,\n  FlexCol, FlexRow,\n  logg,\n} from '$shared'\n\n/**\n * RegisterModal\n**/\nconst RegisterModal = (props) => {\n  // logg(props, 'RegisterModal')\n\n  const {\n    currentUser, setCurrentUser,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'registerModalUsedContext')\n\n  const api = useApi()\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const [ password2, setPassword2 ] = useState('')\n\n  const doRegister = async (email, password, password2) => {\n    if (password !== password2) {\n      return toast('Passwords do not match')\n    }\n    api.doRegister({ email, password }).then((r) => {\n      logg(r, 'registered')\n      localStorage.setItem(C.jwt_token, r.jwt_token)\n      localStorage.setItem(C.current_user, JSON.stringify(r))\n      setCurrentUser(r)\n      setRegisterModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Registration failed\")\n    })\n  }\n\n  return <Modal style={{ zIndex: 3 }} isOpen={registerModalOpen} >\n    <div onClick={() => setRegisterModalOpen(false)}>[x]</div>\n    <FlexCol>\n      <label for='email'>Email</label>\n      <input type='email'    name='email'     value={email}    onChange={(e) => setEmail(e.target.value)    } />\n\n      <label for='password'>Password</label>\n      <input type='password' name='password'  value={password} onChange={(e) => setPassword(e.target.value) } />\n\n      <label for='password2'>Confirm Password</label>\n      <input type='password' name='password2' value={password2} onChange={(e) => setPassword2(e.target.value) } />\n\n      <FlexRow>\n        <Btn onClick={() => doRegister(email, password, password2) }>Register</Btn>\n        <Btn onClick={() => setRegisterModalOpen(false) }>Cancel</Btn>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\n\nexport default RegisterModal\n","\nimport { Plugins } from '@capacitor/core'\nimport React, { createContext, useContext, useState } from 'react'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nexport { default as loginModalStyles } from './LoginModal.scss'\n\n/* A */\nconst AuthContext = createContext({})\nconst AuthContextProvider = ({children, ...props }) => {\n  let { currentUser, setCurrentUser } = props\n  // logg(props, 'AuthContextProvider')\n\n  let defaultUser = localStorage.getItem(C.current_user)\n  defaultUser = defaultUser ? JSON.parse(defaultUser) : C.anonUser\n\n  const [ localCurrentUser, _setCurrentUser ] = useState(defaultUser)\n  const setLocalCurrentUser = (user) => {\n    localStorage.setItem(C.jwt_token, user.jwt_token)\n    localStorage.setItem(C.current_user, JSON.stringify(user))\n    _setCurrentUser(user)\n  }\n  if (!currentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n\n  // @TODO: make these also cascading from the props\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false)\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n  const moreProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n  }\n\n  return <AuthContext.Provider value={{ ...props, ...moreProps }} >\n    { children }\n  </AuthContext.Provider>\n}\n\nexport {\n  AuthContext, AuthContextProvider,\n}\nexport { default as AuthWidget } from './AuthWidget'\n\n\n/* F */\nconst { FacebookLogin: _FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\n\n/**\n * FacebookLogin\n**/\nexport const FacebookLogin = (props) => {\n\n  const {\n    currentUser, setCurrentUser,\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const doFbLogin = async () => {\n    const result = await _FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\n    if (result.accessToken) {\n      request.post(`${config.apiOrigin}${api.longTermTokenPath}`, { accessToken: result.accessToken.token }).then((resp) => {\n        localStorage.setItem(C.jwt_token, resp.data.jwt_token)\n        localStorage.setItem(C.current_user, JSON.stringify(resp.data) )\n        setCurrentUser(resp.data)\n      }).catch((err) => {\n        logg(err, `Could not post request to ${config.apiOrigin}${api.longTermTokenPath}`)\n      })\n    } else {\n      // Canceled by user.\n      logg('canceled')\n    }\n  }\n  return <Btn onClick={doFbLogin}>Login or Register with Facebook</Btn>\n}\n\n/* L */\nexport { default as LoginModal } from \"./LoginModal\"\n\n/* R */\nexport { default as RegisterModal } from \"./RegisterModal\"\n\n\n","\nimport axios from \"axios\"\n\n/*\nimport config from \"config\"\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings)\n*/\n\nexport default axios.create({})\n","\n/**\n * Style Constants\n */\nconst S = {\n  // Twofold layout\n  borderWidth: '10px',\n  bottomDrawerClosedHeight: '20px',\n  bottomDrawerOpenHeight: '115px',\n  breadcrumbsHeight: '30px',\n\n  thinBorderWidth: '2px',\n  thinBorderRadius: '5px',\n}\n\nconst lightTheme = {\n  ...S,\n  thinBorder: '2px solid black',\n  colors: {\n    text: 'black',\n    background: '#dedede',\n    blue: '#6aa3e9',\n    darkGrey: '#605d5d',\n    lightGrey: '#988b8b',\n    red: 'red',\n    border: 'black',\n    cardBackground: 'white'\n  }\n}\n\nconst darkTheme = {\n  ...S,\n  thinBorder: '2px solid white',\n  colors: {\n    text: 'white',\n    background: '#292929',\n    blue: '#73b0fa',\n    darkGrey: '#b3afaf',\n    lightGrey: '#4a4343',\n    red: '#eb83a8',\n    border: 'white',\n    cardBackground: '#1a1a1a'\n  }\n}\n\nexport default {\n  lightTheme,\n  darkTheme\n}","/*\n *  $shared / index\n */\nimport { arrowBack, closeOutline, } from 'ionicons/icons'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport {\n  ChevronLeft as _ChevronLeft,\n  ChevronRight as _ChevronRight,\n  Close as _Close,\n  Menu as _MenuIcon,\n} from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\nimport {\n  Route as _Route, useHistory,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport C from './C'\nimport { AuthContext, AuthContextProvider, } from '$components/users'\n\n/* A */\nconst Actions = styled.div`\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n`;\nexport { Actions, AuthContext, AuthContextProvider, }\n\n/* B */\n\n/**\n * Back Button\n */\n// const BackIcon = styled(IonIcon)\n// @TODO: reintroduce IonIcon maybe?\nconst BackIcon = styled.div`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n`;\n\n\n/* C */\nexport { default as C } from './C'\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * CloseBtn\n**/\nexport const CloseBtn = ({ children, ...props }) => {\n  return <_Close {...props} />\n};\nCloseBtn.propTypes = {\n  onClick: PropTypes.func.isRequred,\n}\n\n/* D */\n\n/* F */\n\n/**\n * FlexCol\n**/\nconst _FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n`;\nexport const FlexCol = ({ children, ...props }) => <_FlexCol className=\"FlexCol\" {...props} >{children}</_FlexCol>\n\n/**\n * FlexRow\n**/\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n`;\n\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0) {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport const TwofoldContext = React.createContext({})\nexport const TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    currentUser, setCurrentUser,\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n    theme, toggleTheme,\n    useApi,\n  } = props\n\n  const api = useApi()\n\n  useEffect(() => {\n    let closure = setTimeout(async () => {\n      const result = await api.getMyAccount()\n      setCurrentUser(result)\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalIsOpen, setPurchaseModalIsOpen ] = useState(false)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser, // @TODO: move this to an AppWrapper context\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalIsOpen, setPurchaseModalIsOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    useApi,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\nTwofoldContextProvider.PropTypes = {\n\n  currentUser: PropTypes.object.isRequired,\n  setCurrentUser: PropTypes.func.isRequired,\n\n  useApi: PropTypes.func.isRequred,\n}\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n * Used in collapsibles and MarkersList\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","/**\n * ishjs / jwt_manager\n */\n\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Btn, C, logg, request } from \"$shared\" // @TODO: alias $shared\n\n\n\n// @TODO: testdrive this context,\n// @TODO: replace TwofoldContext in guydme with the one from ishjs.\nexport const JwtContext = React.createContext({})\nconst JwtContextProvider = ({ children, ...props }) => {\n  logg(props, 'JwtContextProvider')\n  const {\n    api,\n  } = props\n\n  const maybeUser = JSON.parse(localStorage.getItem(C.current_user)) || C.anonUser\n  const [ currentUser, setCurrentUser ] = useState(maybeUser)\n  const [ loginModalOpen, setLoginModalOpen ] = useState({})\n\n  // call to verify creds\n  useEffect(() => {\n    // request.get(`${config.apiOrigin}${config.routes.myAccountPath}`).then((r) => r.data).then((resp) => {\n    api.getMyAccount().then((resp) => {\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n    }).catch((e) => {\n      logg(e, 'e322')\n      // toast(\"Login failed\") // @TODO: re-add toast\n      setCurrentUser(C.anonUser)\n      localStorage.removeItem(C.current_user)\n      localStorage.removeItem(C.jwt_token)\n    })\n  }, [])\n\n  return <JwtContext.Provider value={{\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }} >{ children }</JwtContext.Provider>\n}\nJwtContextProvider.props = {\n  api: PropTypes.object,\n}\nexport { JwtContextProvider }\n\n// @TODO: move to shared?\nconst FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst W1 = styled.div`\n  border: 1px solid red;\n`;\n\nconst W2 = styled.div`\n  display: flex;\n`;\n\nexport const SimpleJwtRow = () => {\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  logg(useContext(JwtContext), 'SimpleJwtRowUsedJwtContext')\n\n  return <W1>\n    <FlexRow>\n      { /* <FbLogin /> */ }\n      { currentUser.email && <W2>\n        <i>{currentUser.email}</i>\n        <Logout />\n      </W2>}\n      { !currentUser.email && <LoginWithPassword /> }\n    </FlexRow>\n  </W1>\n}\n\n\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\nexport const LoginWithPassword = (props) => {\n  // logg(useContext(JwtContext), 'useContext(JwtContext)')\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const doPasswordLogin = async (email, password) => {\n    // logg(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, 'doPasswordLogin')\n    // request.post(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, { email, password }).then((r) => r.data\n    api.postLoginWithPassword({ email, password }).then((resp) => {\n      logg(resp, 'ze resp')\n\n      localStorage.setItem(C.jwt_token, resp.jwt_token)\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') { doPasswordLogin(email, password) }\n      }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n  </_W>\n}\n\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(JwtContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n","/*\n * ishjs / components / users / PasswordLogin\n */\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  Btn, C, logg, request,\n} from \"$shared\"\nimport {\n  AuthContext,\n} from './'\n\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/**\n * Exchange your email and password for a jwt token.\n * api.doLogin() must be present.\n * Requires being wrapped in TwofoldContext, which should have:\n * * currentUser, setCurrentUser,\n * * useApi\n *\n * Sets `C.current_user` and `C.jwt_token` in local storage.\n *\n * Allows logout. (@TODO: not implemented)\n */\nconst PasswordLogin = (props) => {\n  // logg(props, 'PasswordLogin')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    useApi,\n  } = useContext(SimpleContext)\n  // logg(useContext(SimpleContext), 'PasswordLoginUsedContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const api = useApi()\n\n  // api.doLogin = `${config.apiOrigin}${api.loginPath}`\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((resp) => {\n      // localStorage.setItem(C.jwt_token, resp.jwt_token)\n      // localStorage.setItem(C.current_user, JSON.stringify(resp))\n      // setCurrentUser(resp) // must be done *after* setting C.jwt_token\n\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email'    value={email}    onChange={(e) => setEmail(e.target.value)    } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n  </_W>\n}\nPasswordLogin.propTypes = {\n  // none so far\n}\n\nexport default PasswordLogin\n","\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n} from '$components/users'\nimport {\n  Actions,\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nconst W0 = styled.div`\n`;\n\n\n/**\n * A single text area that saves locally and in the cloud.\n */\nconst Scratchpad = (props) => {\n  // logg(props, 'Scratchpad')\n\n  const {\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const [ txt, setTxt ] = useState(localStorage.getItem(C.names.scratchpad) || '')\n\n  const doSave = () => {\n    localStorage.setItem(C.names.scratchpad, txt)\n    api.postProfile({ scratchpad: txt }).then((data) => {\n      // toast('Updated profile.')\n    }).catch((err) => {\n      logg('Cannot update profile:', err)\n      // toast('e54 - Cannot update profile.')\n    })\n  }\n\n  return <W0>\n    <textarea name='scratchpad' rows='20' cols='40'\n      onChange={(e) => setTxt(e.target.value) }\n      value={txt}\n    / >\n    <Actions>\n      <Btn onClick={doSave}>Save</Btn>\n    </Actions>\n  </W0>\n}\nScratchpad.propTypes = {\n  // none so far\n}\n\nexport default Scratchpad\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = ({ children, ...props }) => {\n  const { listItems } = props\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em', zIndex: 1 }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          { listItems.map( ({ label, key, path }) => <ListItem button key={key}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(path())\n            } } >{ label }\n          </ListItem> )}\n\n        </List>\n\n        { children }\n      </W0>\n    </Drawer>\n\n  </F>\n}\n\nSideMenu.propTypes = {\n  listItems: PropTypes.array.isRequired, // @TODO: specify: key, label, path\n  variant: PropTypes.string,\n}\nexport default SideMenu\n"],"names":["C","anonUser","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","map","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","report","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","Equirectangular","MapPanel","MapPanelNoZoom","ThreePanelV1","ThreePanelV4","names","scratchpad","rated","nc17","ratedConfirmation","theme","themes","dark","light","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","RegisterWithEmailBtn","props","LoginWithEmailBtn","AuthWidget","useContext","AuthContext","currentUser","setCurrentUser","setLoginModalOpen","setRegisterModalOpen","doLogout","JSON","stringify","email","F","propTypes","LoginModal","loginModalOpen","useApi","useState","setEmail","password","setPassword","api","doPasswordLogin","postLogin","then","r","toast","err","logg","styles","LoginModalOverlay","flexDirection","e","target","value","key","justifyContent","marginTop","RegisterModal","registerModalOpen","password2","setPassword2","doRegister","localStorage","setItem","zIndex","createContext","AuthContextProvider","children","defaultUser","getItem","parse","localCurrentUser","_setCurrentUser","setLocalCurrentUser","user","moreProps","_FacebookLogin","Plugins","FacebookLogin","FACEBOOK_PERMISSIONS","doFbLogin","login","permissions","result","accessToken","request","post","config","apiOrigin","longTermTokenPath","token","resp","data","axios","create","S","borderWidth","bottomDrawerClosedHeight","bottomDrawerOpenHeight","breadcrumbsHeight","thinBorderWidth","thinBorderRadius","lightTheme","thinBorder","colors","text","background","blue","darkGrey","lightGrey","red","border","cardBackground","darkTheme","Actions","styled","div","BackIcon","Btn","ChevronLeft","_ChevronLeft","p","ChevronRight","_ChevronRight","Card","_Box","cursor","CloseBtn","_Close","onClick","PropTypes","func","isRequred","_FlexCol","FlexCol","FlexRow","_Circle","a","b","c","replace","length","window","console","log","MenuIcon","_MenuIcon","TwofoldContext","React","WBordered","WBorderedItem","Wrapper","ZoomContext","JwtContext","JwtContextProvider","maybeUser","useEffect","getMyAccount","removeItem","object","W1","W2","SimpleJwtRow","_W","LoginWithPassword","postLoginWithPassword","Logout","PasswordLogin","SimpleContext","W0","Scratchpad","txt","setTxt","doSave","postProfile","SideMenu","listItems","drawerOpen","setDrawerOpen","history","useHistory","variant","position","top","left","margin","label","path","push","array","isRequired","string"],"mappings":"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"}