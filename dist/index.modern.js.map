{"version":3,"file":"index.modern.js","sources":["../src/shared/C.jsx","../src/shared/request.jsx","../src/shared/index.jsx","../src/components/users/AuthWidget.jsx","../src/components/users/LoginModal.jsx","../src/components/users/RegisterModal.jsx","../src/components/users/index.jsx","../src/TestApp.jsx","../src/components/users/JwtContext.jsx","../src/components/users/PasswordLogin.jsx","../src/components/users/Scratchpad.jsx","../src/components/SideMenu/index.jsx","../src/index.jsx"],"sourcesContent":["\n/**\n * Constants\n *\n * * C.anonUser\n * * C.current_user\n * * C.jwt_token\n * * C.item_types\n *\n */\nconst C = {\n\n  // A\n  anonUser: {}, // as opposed to null\n\n  // B\n  bottomDrawerOpen: 'bottom-drawer-open', // localStorage\n\n  // C\n  collapsible: {\n    description: \"descr-sec\",\n    extra1: \"extra1-sec\",\n    extra2: \"extra2-sec\",\n    extra3: \"extra3-sec\",\n    map: \"map-sec\",\n    markers: \"markers-sec\",\n  },\n  collapsibles: 'collapsibles', // localStorage\n  current_user: 'current_user',\n\n  // F\n  foldedCenter: 'folded-center',\n  foldedLeft: 'folded-left', // twofoldContext\n  foldedRight: 'folded-right',\n\n  // H\n  horizontal: 'horizontal',\n\n  // I\n  item_types: {\n    gallery: 'Gallery',\n    report: 'Report',\n    video: 'Video',\n  },\n\n  // J\n  jwt_token: 'jwt_token',\n\n  // L\n  layout_onecol: 'onecol',\n  layout_mapui: 'mapui',\n  locations: {\n    earth: 'earth',\n  },\n\n  // M\n  map_panel_types: {\n    Equirectangular: \"Equirectangular\",\n    MapPanel: \"MapPanel\",\n    MapPanelNoZoom: \"MapPanelNoZoom\",\n    ThreePanelV1: \"ThreePanelV1\",\n    ThreePanelV4: \"ThreePanelV4\",\n  },\n\n  // N\n  names: {\n    scratchpad: 'Scratchpad',\n  },\n\n  // R\n  rated: {\n    nc17: 'nc-17',\n  },\n  ratedConfirmation: 'rated-confirmation', // localStorage\n\n  // T\n  theme: 'theme',\n  themes: {\n    dark: 'dark',\n    light: 'light',\n  },\n  twofoldPercent: 'twofold-percent', // localStorage\n\n  // V\n  variants: {\n    bordered: 'bordered', // for Newsitems\n    floating: 'floating', // for main-menu btn\n    inline: 'inline',     // for main-menu btn\n    transparent: 'transparent', // for markers on Right\n  },\n  vertical: 'vertical',\n}\nexport default C\n","\nimport axios from \"axios\"\n\n/*\nimport config from \"config\"\n\nconst settings = {\n  baseURL: config.apiOrigin\n}\n\nexport default axios.create(settings)\n*/\n\nexport default axios.create({})\n","/*\n *  $shared / index\n */\nimport { arrowBack, closeOutline, } from 'ionicons/icons'\nimport { CircularProgress as _CircularProgress } from '@material-ui/core'\nimport _Box from '@material-ui/core/Box'\nimport {\n  ChevronLeft as _ChevronLeft,\n  ChevronRight as _ChevronRight,\n  Close as _Close,\n  Menu as _MenuIcon,\n} from '@material-ui/icons'\nimport PropTypes from 'prop-types'\nimport React, { useEffect, useState } from 'react'\nimport {\n  Route as _Route, useHistory,\n} from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport C from './C'\n\n/* A */\n\nconst Actions = styled.div`\n\n  // @TODO: this should use variables, for Modal inner size.\n  // I'd need to do dependency injection of the variable, from infiniteshelterjs into ishlibjs.\n  position: fixed; // for GalleriesShow\n  top: 60px;\n  right: 60px;\n\n  display: flex;\n  flex-direction: row-reverse;\n`;\nexport { Actions }\n\n/* B */\n\n/**\n * Back Button\n */\n// const BackIcon = styled(IonIcon)\n// @TODO: reintroduce IonIcon maybe?\nconst BackIcon = styled.div`\n  margin-right: 5px;\n  cursor: pointer;\n`;\nexport const BackBtn = () => {\n  const history = useHistory()\n  return <BackIcon onClick={history.goBack} icon={arrowBack}></BackIcon>\n}\n\n/**\n * Just your regular shadowed box. Pointer cursor. TDD\n */\nexport const Btn = styled.div`\n  border: 1px solid gray;\n  border-radius: 5px;\n  cursor: pointer;\n  display: inline-block;\n  padding: .3em 1em;\n`;\n\n\n/* C */\nexport { default as C } from './C'\nexport const ChevronLeft = styled(_ChevronLeft)`\n  color: ${(p) => p.theme.colors.text}\n`;\nexport const ChevronRight = styled(_ChevronRight)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/**\n * Card\n */\nexport const Card = styled(_Box)`\n  margin-bottom: 1em;\n  padding: 1em;\n  background: white;\n  cursor: ${p => p.cursor ? p.cursor : 'auto'};\n\n  display: flex;\n  flex-direction: column;\n`;\n\n/**\n * CloseBtn\n**/\nexport const CloseBtn = ({ children, ...props }) => {\n  return <_Close style={{ cursor: 'pointer', ...props.style }} {...props} />\n};\nCloseBtn.propTypes = {\n  onClick: PropTypes.func.isRequired,\n}\n\n/* D */\n\n/* F */\n\n/**\n * FlexCol\n**/\nconst _FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  > * {\n    margin: auto .4em; // @TODO: standardize this size!\n  }\n`;\nexport const FlexCol = ({ children, ...props }) => <_FlexCol className=\"FlexCol\" {...props} >{children}</_FlexCol>\n\n/**\n * FlexRow\n**/\nexport const FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em; // @TODO: why? the LoginModal needs no margins!\n  }\n`;\n\n\n/* I */\n\n/**\n * Like the rails inflector, has methods:\n * tableize()\n */\nexport const inflector = {\n  tableize: (m) => {\n    switch(m) {\n      case 'Gallery':\n        return 'galleries'\n      default:\n      return `${m.toLowerCase()}s`\n    }\n  },\n}\n\n/* L */\n\n\n// From: https://codepen.io/charlyarg/pen/GByKja\nconst _Circle = styled.div`\n  position: fixed;\n  z-index: 999;\n  overflow: show;\n  margin: auto;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 50px;\n  height: 50px;\n`;\nexport const Loading = (p) => <_Circle><_CircularProgress /></_Circle>\n\n/**\n * Usage: logg(someObject, 'label')\n *\n * This development-grade logger can be used instead of console.log() with some advantages:\n * * It encourages consistent labeling of logs. By labeling each log line, you can have dozens of log lines\n * written per action, and still know which log line comes from where.\n * The recommended label is the component name, or function name.\n * * If the label is present, the logged object is placed in the window, allowing you to inspect it in the console. The\n * label becomes the name of the object (stripped to [0-9a-zA-Z\\-_] chars). If you're logging a function, you can execute it.\n * If you log more than one thing, they can interact, allowing you to validate control flow.\n * * the logger can be turned off by making this function simply return.\n */\nconst logg = (a, b=\"\", c=null) => {\n  c = \"string\" === typeof c ? c : b.replace(/\\W/g, \"\");\n  if (c.length > 0 && typeof window !== \"undefined\") {\n    window[c] = a;\n  }\n\n  console.log(`+++ ${b}:`, a); // eslint-disable-line no-console\n};\n// optimized for Android (e.g. it inspects and doesn't use window)\nconst logg2 = (a, b=\"\", c=null) => {\n  console.log(`+++ ${b}:`, a.inspect); // eslint-disable-line no-console\n};\nexport { logg, logg2 };\n\n/* M */\nexport const MenuIcon = styled(_MenuIcon)`\n  color: ${(p) => p.theme.colors.text}\n`;\n\n/* P */\n\n/**\n * pretty print date\n */\nexport const pp_date = (d) => (d || \"\" ).substring(0, 10)\n\n/* R */\n\nexport { default as request } from \"./request\"\n\n/* S */\nexport { default as S } from \"./S\"\n\n/* T */\n\nexport const TwofoldContext = React.createContext({})\nexport const TwofoldContextProvider = ({ children, ...props }) => {\n  // logg(props, 'TwofoldContextProvider')\n  const {\n    currentUser, setCurrentUser,\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n    theme, toggleTheme,\n    useApi,\n  } = props\n\n  const api = useApi()\n\n  useEffect(() => {\n    let closure = setTimeout(async () => {\n      const result = await api.getMyAccount()\n      setCurrentUser(result)\n    }, 1 * 1000)\n    return () => clearTimeout(closure)\n  }, [currentUser.is_purchasing])\n\n  /* B */\n  // @TODO: does localStorage work like this on mobile?\n  // @TODO: try and catch\n  const [ bottomDrawerOpen, _setBottomDrawerOpen ] = useState(JSON.parse(localStorage.getItem(C.bottomDrawerOpen)))\n  const setBottomDrawerOpen = (m) => {\n    localStorage.setItem(C.bottomDrawerOpen, JSON.stringify(m))\n    _setBottomDrawerOpen(m)\n  }\n\n  /* F */\n  const [ folded, setFolded ] = useState()\n\n  /* I */\n  const [ itemToUnlock, _setItemToUnlock ] = useState({})\n  const setItemToUnlock = (item) => {\n    if (itemToUnlock.id !== item.id && !loginModalOpen) {\n      _setItemToUnlock(item)\n    }\n  }\n\n  /* M */\n  const [ mapPanelWidth, setMapPanelWidth ] = useState(null)\n  const [ mapPanelHeight, setMapPanelHeight ] = useState(null)\n\n  /* P */\n  const [ purchaseModalIsOpen, setPurchaseModalIsOpen ] = useState(false)\n\n  /* R */\n  const [ ratedConfirmation, _setRatedConfirmation ] = useState(JSON.parse(localStorage.getItem(C.ratedConfirmation)))\n  const setRatedConfirmation = (which) => {\n    localStorage.setItem(C.ratedConfirmation, JSON.stringify(which))\n    _setRatedConfirmation(which)\n  }\n\n  /* S */\n  const [ showItem, setShowItem ] = useState(false)\n  const [ showUrl, setShowUrl ] = useState(false)\n\n  /* T */\n  let tmp, defaultTwofoldPercent = 0.5\n  if (tmp = localStorage.getItem(C.twofoldPercent)) {\n    try {\n      defaultTwofoldPercent = JSON.parse(tmp)\n    } catch (err) {\n      logg(err, 'cannot get twofoldPercent from localStorage')\n    }\n  }\n  const [ twofoldPercent, setTwofoldPercent ] = useState(0.5)\n\n  /* Z */\n  const [ zoom, setZoom ] = useState(1)\n\n  return <TwofoldContext.Provider value={{\n    bottomDrawerOpen, setBottomDrawerOpen,\n\n    currentUser, setCurrentUser, // @TODO: move this to an AppWrapper context\n\n    folded, setFolded,\n\n    itemToUnlock, setItemToUnlock,\n\n    layout, setLayout,\n    loginModalOpen, setLoginModalOpen,\n\n    mapPanelHeight, setMapPanelHeight,\n    mapPanelWidth, setMapPanelWidth,\n\n    purchaseModalIsOpen, setPurchaseModalIsOpen,\n\n    ratedConfirmation, setRatedConfirmation,\n\n    showItem, setShowItem,\n    showUrl, setShowUrl,\n\n    twofoldPercent, setTwofoldPercent,\n\n    useApi,\n\n    zoom, setZoom,\n\n    theme, toggleTheme,\n  }} >{ children }</TwofoldContext.Provider>\n}\nTwofoldContextProvider.propTypes = {\n  currentUser: PropTypes.object.isRequired,\n  setCurrentUser: PropTypes.func.isRequired,\n\n  useApi: PropTypes.func.isRequired,\n}\n\n/* U */\nexport { default as useWindowSize } from './useWindowSize'\n\n/* W */\n\n/**\n * Wrapper Bordered. This expects a list? _vp_ 2021-11-02\n * Used in collapsibles and MarkersList\n */\nexport const WBordered = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  padding: .5em;\n\n  margin-bottom: 1em;\n`;\n\n/**\n * Wrapper Bordered Item. Is padded, margined.\n */\nexport const WBorderedItem = styled.div`\n  border: ${p => p.theme.thinBorder};\n  border-radius: ${p => p.theme.thinBorderRadius};\n  background: ${p => p.theme.colors.cardBackground};\n  color: ${p => p.theme.colors.text};\n\n  margin: 0 .5em .5em 0;\n  padding: .5em;\n\n  text-align: center;\n\n  width: 18%;\n  max-width: 140px;\n  min-width: 120px;\n`;\n\n\nexport const WidgetContainer = ({ children, ...props }) => {\n  return <WBordered {...props} >{ children }</WBordered>\n}\n\nexport const Wrapper = styled.div`\n  height: 100vh;\n`;\n\n/* Z */\n\nexport const ZoomContext = React.createContext({})\n\n\n\n","\nimport React, { Fragment as F, useContext, } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext, AuthContextProvider,\n  FacebookLogin,\n  LoginModal, LoginWithEmail,\n  RegisterModal, RegisterWithEmail,\n} from \"$components/users\"\n\nimport {\n  Btn,\n  C,\n  FlexCol, FlexRow,\n\n  logg,\n} from \"$shared\"\n\n\nconst RegisterWithEmailBtn = (props) => {\n  return <Btn {...props} >Register with Email</Btn>\n}\nconst LoginWithEmailBtn = (props) => {\n  return <Btn {...props} >Login with Email</Btn>\n}\n\n\n/**\n * If user is logged in, display the email/handle and allow logout.\n * If user is not logged in, allow registration and login via Fb, and email+passwd.\n**/\nconst AuthWidget = (props) => {\n  // logg(props, 'AuthWidget')\n\n  const {\n    currentUser, setCurrentUser,\n    setLoginModalOpen,\n    setRegisterModalOpen,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'AuthWidgetUsedAuthContext')\n\n  // @TODO: does this belong here?\n  const doLogout = () => {\n    setCurrentUser(JSON.stringify(C.anonUser))\n  }\n\n  if (currentUser?.email) {\n    return <FlexRow>\n      [{currentUser.email} <Btn onClick={doLogout} >Logout</Btn> ]\n    </FlexRow>\n  }\n\n  return <F>\n    <FlexCol>\n      {/* <FacebookLogin /> */}\n      <RegisterWithEmailBtn onClick={() => { setRegisterModalOpen(true) }} />\n      <LoginWithEmailBtn    onClick={() => { setLoginModalOpen(true) }} />\n    </FlexCol>\n\n    <RegisterModal />\n    <LoginModal />\n\n  </F>\n};\nAuthWidget.propTypes = {\n  // none so far\n}\n\nexport default AuthWidget\n","\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport styled from 'styled-components'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthContext, AuthContextProvider,\n} from './'\n\n\nimport styles from './LoginModal.module.scss'\n\n// copy-pasted in RegisterModal\nexport const Header = styled.div`\n  flex-grow: 1;\n  text-align: center;\n  font-size: 1.2rem;\n`;\n\n/**\n * LoginModal\n**/\nconst LoginModal = (props) => {\n  // logg(props, 'LoginModal, ishlibjs')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'LoginModalUsedAuthContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const api = useApi()\n\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((r) => {\n      setLoginModalOpen(false)\n      toast('Login Successful.')\n    }).catch((err) => {\n      logg(err, 'e323 - cannot postLogin()')\n      setCurrentUser(C.anonUser)\n      toast(\"Login failed\")\n    })\n  }\n\n  Modal.setAppElement('body')\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={!!loginModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <FlexRow >\n      <Header>Login</Header>\n      <CloseBtn onClick={() => setLoginModalOpen(false)} />\n    </FlexRow>\n    { 'string' === typeof loginModalOpen && <FlexRow>\n      <div className={styles.Notice} >{ loginModalOpen }</div>\n    </FlexRow> }\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input name='email' type='email' value={email} onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input name='password' type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n        onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n      />\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n      </FlexRow>\n    </FlexCol>\n    <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n    <FlexRow style={{ justifyContent: 'center' }} >\n      <a href='#' onClick={() => setLoginModalOpen(false) || setRegisterModalOpen(true) }>Register Instead</a>\n    </FlexRow>\n  </Modal>\n}\n\nexport default LoginModal\n","\nimport React, { useContext, useState, } from 'react'\nimport Modal from \"react-modal\"\nimport { toast } from 'react-toastify'\nimport PropTypes from 'prop-types'\n\nimport {\n  Btn,\n  C, CloseBtn,\n  FlexCol, FlexRow,\n  logg,\n} from '$shared'\nimport {\n  AuthContext,\n} from '$components/users'\n\nimport { Header } from './LoginModal'\nimport styles from './LoginModal.module.scss'\n\n\n/**\n * RegisterModal\n *\n * Uses LoginModal styling\n**/\nconst RegisterModal = (props) => {\n  // logg(props, 'RegisterModal')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(AuthContext), 'registerModalUsedContext')\n\n  const api = useApi()\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n  const [ password2, setPassword2 ] = useState('')\n\n  const doRegister = async (email, password, password2) => {\n    if (password !== password2) {\n      toast('Passwords do not match')\n      return\n    }\n    const out = api.doRegister({ email, password })\n    logg(out, '#doRegister')\n    out.then((r) => {\n      logg(r, 'registered')\n      // localStorage.setItem(C.jwt_token, r.jwt_token)\n      // localStorage.setItem(C.current_user, JSON.stringify(r))\n      // setCurrentUser(r)\n      setRegisterModalOpen(false)\n      setLoginModalOpen(r.message)\n      toast('success (remove)')\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Registration failed\")\n    })\n  }\n\n  return <Modal\n    className={`LoginModal ${styles.LoginModal}`}\n    isOpen={registerModalOpen}\n    overlayClassName={styles.LoginModalOverlay}\n    portalClassName={styles.LoginModalPortal}\n  >\n    <FlexRow >\n      <Header>Register</Header>\n      <CloseBtn onClick={() => setRegisterModalOpen(false)} />\n    </FlexRow>\n    <FlexCol>\n      <label htmlFor='email'>Email</label>\n      <input type='email'    name='email'     value={email}    onChange={(e) => setEmail(e.target.value)    } />\n\n      <label htmlFor='password'>Password</label>\n      <input type='password' name='password'  value={password} onChange={(e) => setPassword(e.target.value) } />\n\n      <label htmlFor='password2'>Confirm Password</label>\n      <input type='password' name='password2' value={password2} onChange={(e) => setPassword2(e.target.value) } />\n\n      <FlexRow style={{\n        flexDirection: 'row-reverse',\n        justifyContent: 'space-between',\n        marginTop: '0.4em',\n      }} >\n        <Btn className=\"Submit\" onClick={() => doRegister(email, password, password2) }>Register</Btn>\n      </FlexRow>\n      <hr style={{ margin: '2rem 0', borderWidth: '1px' }} />\n      <FlexRow style={{ justifyContent: 'center' }} >\n        <a href='#' onClick={() => setLoginModalOpen(true) || setRegisterModalOpen(false) }>Login Instead</a>\n      </FlexRow>\n    </FlexCol>\n  </Modal>\n}\nRegisterModal.propTypes = {} // None so far\n\nexport default RegisterModal\n","\nimport { Plugins } from '@capacitor/core'\nimport React, { createContext, useContext, useState } from 'react'\n\nimport {\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\n// export { default as loginModalStyles } from './LoginModal.scss'\n\n/* A */\nconst AuthContext = createContext({})\nconst AuthContextProvider = ({children, ...props }) => {\n  let {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen: _registerModalOpen, setRegisterModalOpen: _setRegisterModalOpen,\n  } = props\n  // logg(props, 'AuthContextProvider')\n\n  let defaultUser = localStorage.getItem(C.current_user)\n  defaultUser = defaultUser ? JSON.parse(defaultUser) : C.anonUser\n\n  const [ localCurrentUser, _setCurrentUser ] = useState(defaultUser)\n  const setLocalCurrentUser = (user) => {\n    localStorage.setItem(C.jwt_token, user.jwt_token)\n    localStorage.setItem(C.current_user, JSON.stringify(user))\n    _setCurrentUser(user)\n  }\n  if (!setCurrentUser) {\n    currentUser = localCurrentUser\n    setCurrentUser = setLocalCurrentUser\n  }\n\n  const [ _loginModalOpen, _setLoginModalOpen ] = useState(false)\n  if (typeof loginModalOpen === 'undefined') {\n    loginModalOpen = _loginModalOpen\n    setLoginModalOpen = _setLoginModalOpen\n  }\n\n\n  let [ registerModalOpen, setRegisterModalOpen ] = useState(false)\n  if (_registerModalOpen) {\n    registerModalOpen = _registerModalOpen\n    setRegisterModalOpen = _setRegisterModalOpen\n  }\n  const moreProps = {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n  }\n\n  return <AuthContext.Provider value={{ ...props, ...moreProps }} >\n    { children }\n  </AuthContext.Provider>\n}\n\nexport {\n  AuthContext, AuthContextProvider,\n}\nexport { default as AuthWidget } from './AuthWidget'\n\n/* F */\nconst { FacebookLogin: _FacebookLogin } = Plugins\n\nconst FACEBOOK_PERMISSIONS = ['email']\n\n/* J */\n\n\n\n/* L */\nexport { default as LoginModal } from \"./LoginModal\"\n\n/* R */\nexport { default as RegisterModal } from \"./RegisterModal\"\n\n\n","\nimport React, { useState, } from 'react'\nimport { toast, ToastContainer } from 'react-toastify'\n\nimport 'react-toastify/dist/ReactToastify.css'\n\nimport {\n  logg,\n  request,\n} from \"$shared\"\nimport {\n  AuthWidget,\n  AuthContextProvider,\n  LoginModal,\n } from './components/users'\n\nconst config = {\n  apiOrigin: 'http://localhost:3001',\n}\n\nconst TestApp = () => {\n\n  const useApi = () => ({\n    doRegister: ({ email, password }) => {\n      return request.post(`${config.apiOrigin}/api/users`, { email, password }).then((r) => r.data).then((r) => {\n        logg(r, 'done registered')\n        return r\n      })\n    },\n  })\n\n  const [ loginModalOpen, setLoginModalOpen ] = useState(false) // useState(\"Please login!\")\n  const [ registerModalOpen, setRegisterModalOpen ] = useState(true) // useState(\"Please register\")\n\n  return <AuthContextProvider {...{\n    loginModalOpen, setLoginModalOpen,\n    registerModalOpen, setRegisterModalOpen,\n    useApi,\n  }} >\n\n    {/* <LoginModal /> */}\n    <AuthWidget />\n\n    <ToastContainer position=\"bottom-left\" />\n  </AuthContextProvider>\n}\nexport default TestApp\n","/**\n * ishjs / jwt_manager\n */\n\nimport PropTypes from 'prop-types'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Btn, C, logg, request } from \"$shared\" // @TODO: alias $shared\n\n\n\n// @TODO: testdrive this context,\n// @TODO: replace TwofoldContext in guydme with the one from ishjs.\nexport const JwtContext = React.createContext({})\nconst JwtContextProvider = ({ children, ...props }) => {\n  logg(props, 'JwtContextProvider')\n  const {\n    api,\n  } = props\n\n  const maybeUser = JSON.parse(localStorage.getItem(C.current_user)) || C.anonUser\n  const [ currentUser, setCurrentUser ] = useState(maybeUser)\n  const [ loginModalOpen, setLoginModalOpen ] = useState({})\n\n  // call to verify creds\n  useEffect(() => {\n    // request.get(`${config.apiOrigin}${config.routes.myAccountPath}`).then((r) => r.data).then((resp) => {\n    api.getMyAccount().then((resp) => {\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n    }).catch((e) => {\n      logg(e, 'e322')\n      // toast(\"Login failed\") // @TODO: re-add toast\n      setCurrentUser(C.anonUser)\n      localStorage.removeItem(C.current_user)\n      localStorage.removeItem(C.jwt_token)\n    })\n  }, [])\n\n  return <JwtContext.Provider value={{\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  }} >{ children }</JwtContext.Provider>\n}\nJwtContextProvider.props = {\n  api: PropTypes.object,\n}\nexport { JwtContextProvider }\n\n// @TODO: move to shared?\nconst FlexRow = styled.div`\n  display: flex;\n\n  > * {\n    margin: auto .4em;\n  }\n`;\n\nconst W1 = styled.div`\n  border: 1px solid red;\n`;\n\nconst W2 = styled.div`\n  display: flex;\n`;\n\nexport const SimpleJwtRow = () => {\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  logg(useContext(JwtContext), 'SimpleJwtRowUsedJwtContext')\n\n  return <W1>\n    <FlexRow>\n      { /* <FbLogin /> */ }\n      { currentUser.email && <W2>\n        <i>{currentUser.email}</i>\n        <Logout />\n      </W2>}\n      { !currentUser.email && <LoginWithPassword /> }\n    </FlexRow>\n  </W1>\n}\n\n\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\nexport const LoginWithPassword = (props) => {\n  // logg(useContext(JwtContext), 'useContext(JwtContext)')\n  const {\n    api,\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n  } = useContext(JwtContext)\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const doPasswordLogin = async (email, password) => {\n    // logg(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, 'doPasswordLogin')\n    // request.post(`${config.apiOrigin}${config.routes.loginWithPasswordPath}`, { email, password }).then((r) => r.data\n    api.postLoginWithPassword({ email, password }).then((resp) => {\n      logg(resp, 'ze resp')\n\n      localStorage.setItem(C.jwt_token, resp.jwt_token)\n      localStorage.setItem(C.current_user, JSON.stringify(resp))\n      setCurrentUser(resp) // must be done *after* setting C.jwt_token\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      // toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email' value={email} onChange={(e) => setEmail(e.target.value) } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => {\n        if (e.key === 'Enter') { doPasswordLogin(email, password) }\n      }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Login</Btn>\n  </_W>\n}\n\n\nexport const Logout = () => {\n  const { currentUser, setCurrentUser } = useContext(JwtContext)\n  const doLogout = () => {\n    localStorage.removeItem(C.jwt_token)\n    localStorage.removeItem(C.current_user)\n    setCurrentUser({})\n  }\n  return <Btn onClick={doLogout}>Logout</Btn>\n}\n","/*\n * ishjs / components / users / PasswordLogin\n */\n\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useState, } from 'react'\nimport { ToastContainer, toast } from 'react-toastify'\nimport styled from 'styled-components'\n\nimport {\n  Btn, C, logg, request,\n} from \"$shared\"\nimport {\n  AuthContext,\n} from './'\n\n// @TODO: do I even need to re-add this? ishlibjs is *always* used from elsewhere.\n// import 'react-toastify/dist/ReactToastify.css'\n\nconst _W = styled.div`\n  display: flex;\n\n  > * {\n    // margin: auto .4em;\n  }\n`;\n\n/**\n * Exchange your email and password for a jwt token.\n * api.doLogin() must be present.\n * Requires being wrapped in TwofoldContext, which should have:\n * * currentUser, setCurrentUser,\n * * useApi\n *\n * Sets `C.current_user` and `C.jwt_token` in local storage.\n *\n * Allows logout. (@TODO: not implemented)\n */\nconst PasswordLogin = (props) => {\n  // logg(props, 'PasswordLogin')\n\n  const {\n    currentUser, setCurrentUser,\n    loginModalOpen, setLoginModalOpen,\n    useApi,\n  } = useContext(AuthContext)\n  // logg(useContext(SimpleContext), 'PasswordLoginUsedContext')\n\n  const [ email, setEmail ] = useState('')\n  const [ password, setPassword ] = useState('')\n\n  const api = useApi()\n\n  // api.doLogin = `${config.apiOrigin}${api.loginPath}`\n  const doPasswordLogin = async (email, password) => {\n    api.postLogin({ email, password }).then((resp) => {\n      // localStorage.setItem(C.jwt_token, resp.jwt_token)\n      // localStorage.setItem(C.current_user, JSON.stringify(resp))\n      // setCurrentUser(resp) // must be done *after* setting C.jwt_token\n\n      setLoginModalOpen(false)\n    }).catch((e) => {\n      logg(e, 'e322')\n      toast(\"Login failed\")\n      setCurrentUser(C.anonUser)\n    })\n  }\n\n  return <_W>\n    <input type='email'    value={email}    onChange={(e) => setEmail(e.target.value)    } /><br />\n    <input type='password' value={password} onChange={(e) => setPassword(e.target.value) }\n      onKeyDown={(e) => { if (e.key === 'Enter') { doPasswordLogin(email, password) } }}\n    />\n    <Btn onClick={() => doPasswordLogin(email, password)}>Password Login</Btn>\n  </_W>\n}\nPasswordLogin.propTypes = {\n  // None so far\n}\n\nexport default PasswordLogin\n","\nimport React, { Fragment as F, useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\n\nimport {\n  AuthContext,\n} from '$components/users'\nimport {\n  Actions,\n  Btn,\n  C,\n  logg,\n} from '$shared'\n\nconst W0 = styled.div`\n`;\n\n\n/**\n * A single text area that saves locally and in the cloud.\n */\nconst Scratchpad = (props) => {\n  // logg(props, 'Scratchpad')\n\n  const {\n    useApi,\n  } = useContext(AuthContext)\n\n  const api = useApi()\n\n  const [ txt, setTxt ] = useState(localStorage.getItem(C.names.scratchpad) || '')\n\n  const doSave = () => {\n    localStorage.setItem(C.names.scratchpad, txt)\n    api.postProfile({ scratchpad: txt }).then((data) => {\n      // toast('Updated profile.')\n    }).catch((err) => {\n      logg('Cannot update profile:', err)\n      // toast('e54 - Cannot update profile.')\n    })\n  }\n\n  return <W0>\n    <textarea name='scratchpad' rows='20' cols='40'\n      onChange={(e) => setTxt(e.target.value) }\n      value={txt}\n    / >\n    <Actions>\n      <Btn onClick={doSave}>Save</Btn>\n    </Actions>\n  </W0>\n}\nScratchpad.propTypes = {\n  // none so far\n}\n\nexport default Scratchpad\n","import { IonApp, IonButtons, IonMenuButton } from '@ionic/react'\nimport Drawer from '@material-ui/core/Drawer'\nimport Fab from '@material-ui/core/Fab'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport PropTypes from 'prop-types'\nimport React, { Fragment as F, useContext, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport styled from 'styled-components'\n\nimport {\n  C,\n  logg,\n  MenuIcon,\n} from \"$shared\"\n\nconst W0 = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-content: space-between;\n`;\n\n\nconst SideMenu = ({ children, ...props }) => {\n  const { listItems } = props\n  // logg(props, 'SideMenu')\n\n  const [ drawerOpen, setDrawerOpen ] = React.useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const history = useHistory()\n\n  return <F>\n\n    { /* @TODO: probably remove from here, too many variations of the button, it gotta be separate */ }\n    { props.variant === C.variants.floating ?\n      <Fab onClick={() => setDrawerOpen(true)} style={{ position: 'absolute', top: 0, left: 0, margin: '.5em', zIndex: 1 }} aria-label='main menu'><MenuIcon /></Fab>\n      : <MenuIcon onClick={() => setDrawerOpen(true)} /> }\n\n    <Drawer anchor={\"left\"} open={drawerOpen} onClose={() => setDrawerOpen(false)} >\n      <W0>\n        <List>\n\n          { listItems.map( ({ label, key, path }) => <ListItem button key={key}\n            onClick={() => {\n              setDrawerOpen(false)\n              history.push(path())\n            } } >{ label }\n          </ListItem> )}\n\n        </List>\n\n        { children }\n      </W0>\n    </Drawer>\n\n  </F>\n}\n\nSideMenu.propTypes = {\n  listItems: PropTypes.array.isRequired, // @TODO: specify: key, label, path\n  variant: PropTypes.string,\n}\nexport default SideMenu\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport {\n  logg,\n} from \"./shared\"\nimport App from './TestApp'\n\n// @TODO: rename\nimport * as jwtManager from './components/users/JwtContext' // this syntax is correct\n\n/* A */\nexport { Actions, } from './shared'\nexport { AuthContext, AuthContextProvider, } from './components/users'\nexport { default as AuthWidget } from \"./components/users/AuthWidget\"\n\n/* C */\nexport { CloseBtn } from './shared'\n\n/* F */\nexport { FlexCol, FlexRow } from \"./shared\"\n\n/* J */\nexport { jwtManager }\n\n/* L */\nexport { logg }\nexport { default as LoginModal } from './components/users/LoginModal'\n// export { default as loginModalStyles } from './components/users/LoginModal.scss'\n\n/* P */\nexport { default as PasswordLogin } from \"./components/users/PasswordLogin\"\n\n/* R */\nexport { RegisterModal } from './components/users'\n\n/* S */\nexport { default as Scratchpad } from \"./components/users/Scratchpad\"\nexport { default as SideMenu } from './components/SideMenu'\n\nif (process.env.REACT_APP_SERVE) {\n  ReactDOM.render(<App />, document.getElementById('root'))\n}\n"],"names":["C","anonUser","bottomDrawerOpen","collapsible","description","extra1","extra2","extra3","map","markers","collapsibles","current_user","foldedCenter","foldedLeft","foldedRight","horizontal","item_types","gallery","report","video","jwt_token","layout_onecol","layout_mapui","locations","earth","map_panel_types","Equirectangular","MapPanel","MapPanelNoZoom","ThreePanelV1","ThreePanelV4","names","scratchpad","rated","nc17","ratedConfirmation","theme","themes","dark","light","twofoldPercent","variants","bordered","floating","inline","transparent","vertical","axios","create","Actions","styled","div","BackIcon","Btn","ChevronLeft","_ChevronLeft","p","colors","text","ChevronRight","_ChevronRight","Card","_Box","cursor","CloseBtn","props","_Close","style","propTypes","onClick","PropTypes","func","isRequired","_FlexCol","FlexCol","children","FlexRow","_Circle","logg","a","b","c","replace","length","window","console","log","MenuIcon","_MenuIcon","TwofoldContext","React","createContext","WBordered","thinBorder","thinBorderRadius","cardBackground","WBorderedItem","Wrapper","ZoomContext","RegisterWithEmailBtn","LoginWithEmailBtn","AuthWidget","useContext","AuthContext","currentUser","setCurrentUser","setLoginModalOpen","setRegisterModalOpen","doLogout","JSON","stringify","email","F","Header","LoginModal","loginModalOpen","registerModalOpen","useApi","useState","setEmail","password","setPassword","api","doPasswordLogin","postLogin","then","r","toast","catch","err","Modal","setAppElement","styles","LoginModalOverlay","LoginModalPortal","Notice","e","target","value","key","flexDirection","justifyContent","marginTop","margin","borderWidth","RegisterModal","password2","setPassword2","doRegister","out","message","AuthContextProvider","_registerModalOpen","_setRegisterModalOpen","defaultUser","localStorage","getItem","parse","localCurrentUser","_setCurrentUser","setLocalCurrentUser","user","setItem","_loginModalOpen","_setLoginModalOpen","moreProps","config","apiOrigin","TestApp","request","post","data","JwtContext","JwtContextProvider","maybeUser","useEffect","getMyAccount","resp","removeItem","object","W1","W2","SimpleJwtRow","_W","LoginWithPassword","postLoginWithPassword","Logout","PasswordLogin","W0","Scratchpad","txt","setTxt","doSave","postProfile","SideMenu","listItems","drawerOpen","setDrawerOpen","history","useHistory","variant","position","top","left","zIndex","label","path","push","array","string","process","env","REACT_APP_SERVE","ReactDOM","render","App","document","getElementById"],"mappings":"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"}